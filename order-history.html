<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>My Orders | PlayWithEase</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:Poppins,Arial;background:#f8fafc;margin:0}
header{background:#2563eb;color:#fff;padding:16px}
.order{
  background:#fff;
  margin:16px;
  padding:14px;
  border-radius:14px;
}
.status{
  font-size:12px;
  font-weight:700;
}
.in-progress{color:#f59e0b}
.success{color:#16a34a}
.cancelled{color:#dc2626}
</style>
</head>

<body>

<header>
  <h2>ðŸ“¦ My Orders</h2>
</header>

<div id="box"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import {
  getFirestore,
  collection,
  query,
  where,
  orderBy,
  getDocs
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAxuYwom2tuGTz3Nsi-6ndYSwK7BkEJIVs",
  authDomain: "playwithease.firebaseapp.com",
  projectId: "playwithease"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const box = document.getElementById("box");

onAuthStateChanged(auth, async (user)=>{
  if(!user){
    box.innerHTML = "<p style='padding:16px'>Please login</p>";
    return;
  }

  const q = query(
    collection(db,"orders"),
    where("userId","==",user.uid),
    orderBy("createdAt","desc")
  );

  const snap = await getDocs(q);
  box.innerHTML = "";

  if(snap.empty){
    box.innerHTML = "<p style='padding:16px'>No orders yet</p>";
    return;
  }

  snap.forEach(doc=>{
    const o = doc.data();
    box.innerHTML += `
      <div class="order">
        <b>â‚¹${o.total}</b><br>
        <span class="status ${o.status}">
          ${o.status}
        </span>
        <ul>
          ${o.items.map(i=>`<li>${i.name}</li>`).join("")}
        </ul>
      </div>
    `;
  });
});
</script>

</body>
</html>
