<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PlayWithEase - Cart</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}

:root{
--bg:#f8fafc;
--card:#ffffff;
--accent:#2563eb;
--text:#0f172a;
}

body{
font-family:'Poppins',sans-serif;
background:var(--bg);
color:var(--text);
transition:.3s;
min-height:100vh;
}

/* THEMES */
body.theme-dark{--bg:#0f172a;--card:#1e293b;--accent:#3b82f6;--text:#f1f5f9;}
body.theme-emerald{--accent:#10b981;}
body.theme-royal{--accent:#7c3aed;}
body.theme-elite-red{--bg:#14090b;--card:#1f1114;--accent:#dc2626;--text:#fef2f2;}

.header{
display:flex;
justify-content:space-between;
align-items:center;
padding:20px 30px;
}

.brand{
font-family:'Orbitron';
font-weight:900;
font-size:22px;
text-decoration:none;
color:inherit;
}

.theme-btn{
padding:8px 18px;
border:none;
border-radius:12px;
background:linear-gradient(135deg,var(--accent),#1d4ed8);
color:#fff;
font-weight:600;
cursor:pointer;
}

.container{
max-width:1100px;
margin:auto;
padding:20px;
}

.cart-item{
background:var(--card);
border-radius:18px;
padding:20px;
margin-bottom:20px;
display:flex;
gap:20px;
align-items:center;
box-shadow:0 15px 40px rgba(0,0,0,.08);
}

.cart-item img{width:140px;border-radius:12px;}
.item-info{flex:1;}
.item-name{font-weight:600;margin-bottom:6px;}

.qty-box{display:flex;gap:10px;margin-top:10px;}
.qty-btn{
background:var(--accent);
border:none;color:#fff;
padding:5px 12px;border-radius:8px;cursor:pointer;
}

.remove-btn{
background:#ef4444;
border:none;color:#fff;
padding:6px 12px;border-radius:8px;cursor:pointer;
margin-top:10px;
}

.summary{
margin-top:40px;
background:var(--card);
padding:30px;
border-radius:20px;
box-shadow:0 15px 40px rgba(0,0,0,.1);
}

.summary-row{
display:flex;
justify-content:space-between;
margin-bottom:10px;
}

.total{font-size:20px;font-weight:700;}

.checkout-btn{
width:100%;
padding:14px;
border:none;
border-radius:14px;
background:linear-gradient(135deg,var(--accent),#1d4ed8);
color:#fff;
font-size:16px;
font-weight:700;
cursor:pointer;
margin-top:20px;
}

/* ===== OVERLAY ===== */

.overlay{
position:fixed;
inset:0;
background:rgba(0,0,0,.6);
display:none;
align-items:center;
justify-content:center;
z-index:9999;
}

.modal{
background:var(--card);
padding:30px;
border-radius:20px;
width:360px;
text-align:center;
box-shadow:0 30px 80px rgba(0,0,0,.4);
animation:pop .3s ease;
}

.modal img{width:200px;margin-top:10px;border-radius:12px;}

.timer{
margin-top:10px;
font-weight:600;
color:var(--accent);
}

.modal-btn{
width:100%;
margin-top:10px;
padding:10px;
border:none;
border-radius:10px;
cursor:pointer;
font-weight:600;
}

.cancel{background:#ef4444;color:#fff;}
.paid{background:var(--accent);color:#fff;}
.back{background:#111;color:#fff;}

@keyframes pop{
from{transform:scale(.8);opacity:0;}
to{transform:scale(1);opacity:1;}
}
</style>
</head>

<body>

<div class="header">
<a href="index.html" class="brand">PlayWithEase®</a>
<button id="themeSwitcher" class="theme-btn">Theme</button>
</div>

<div class="container">
<h2>Your Cart</h2>
<div id="cartContainer"></div>

<div class="summary" id="summaryBox" style="display:none;">
<div class="summary-row">
<span>Subtotal</span>
<span id="subtotal"></span>
</div>
<div class="summary-row">
<span>GST</span>
<span>Not Applicable</span>
</div>
<div class="summary-row total">
<span>Total</span>
<span id="grandTotal"></span>
</div>

<button class="checkout-btn" onclick="openPayment()">Checkout</button>
</div>
</div>

<!-- OVERLAY -->
<div class="overlay" id="paymentOverlay">
<div class="modal">
<h3>Complete Your Payment</h3>
<p><b>UPI ID:</b> shayanff98@okhdfcbank</p>
<img id="upiQR">
<div class="timer" id="countdown">10:00</div>

<button class="modal-btn paid" onclick="confirmPaid()">I've Paid</button>
<button class="modal-btn cancel" onclick="closePayment()">Cancel Payment</button>
<button class="modal-btn back" onclick="window.location.href='index.html'">Back to Store</button>
</div>
</div>

<script>
let cart = JSON.parse(localStorage.getItem("pwe_cart")) || [];

cart = cart.map(item=>{
if(typeof item === "string"){
return {name:item,image:"https://via.placeholder.com/140x80?text=Game",price:999,qty:1};
}
return {name:item.name,image:item.image||"",price:item.price||999,qty:item.qty||1};
});

function renderCart(){
const container=document.getElementById("cartContainer");
const subtotalEl=document.getElementById("subtotal");
const totalEl=document.getElementById("grandTotal");
const summary=document.getElementById("summaryBox");

container.innerHTML="";
if(cart.length===0){summary.style.display="none";return;}
summary.style.display="block";

let subtotal=0;

cart.forEach((item,index)=>{
subtotal+=item.price*item.qty;

container.innerHTML+=`
<div class="cart-item">
<img src="${item.image}">
<div class="item-info">
<div class="item-name">${item.name}</div>
<div>₹${item.price}</div>
<div class="qty-box">
<button class="qty-btn" onclick="changeQty(${index},-1)">-</button>
<span>${item.qty}</span>
<button class="qty-btn" onclick="changeQty(${index},1)">+</button>
</div>
<button class="remove-btn" onclick="removeItem(${index})">Remove</button>
</div>
</div>
`;
});

subtotalEl.innerText="₹"+subtotal;
totalEl.innerText="₹"+subtotal;
}

function changeQty(i,c){
cart[i].qty+=c;
if(cart[i].qty<=0)cart.splice(i,1);
localStorage.setItem("pwe_cart",JSON.stringify(cart));
renderCart();
}

function removeItem(i){
cart.splice(i,1);
localStorage.setItem("pwe_cart",JSON.stringify(cart));
renderCart();
}

/* PAYMENT OVERLAY */
let timerInterval;

function openPayment(){
let total = cart.reduce((s,i)=>s+i.price*i.qty,0);
document.getElementById("paymentOverlay").style.display="flex";

document.getElementById("upiQR").src =
`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=upi://pay?pa=shayanff98@okhdfcbank&pn=PlayWithEase&am=${total}&cu=INR`;

startTimer(600);
}

function closePayment(){
document.getElementById("paymentOverlay").style.display="none";
clearInterval(timerInterval);
}

function startTimer(seconds){
let time=seconds;
timerInterval=setInterval(()=>{
let min=Math.floor(time/60);
let sec=time%60;
document.getElementById("countdown").innerText=
(min<10?"0":"")+min+":"+(sec<10?"0":"")+sec;
time--;
if(time<0)clearInterval(timerInterval);
},1000);
}

function confirmPaid(){
let total = cart.reduce((s,i)=>s+i.price*i.qty,0);

let details="";
cart.forEach((item,index)=>{
details+=`${index+1}. ${item.name}%0AQty: ${item.qty}%0APrice: ₹${item.price}%0A%0A`;
});

let msg=
`Hello PlayWithEase Team,%0A%0AI have completed payment.%0A%0A`+
details+
`Total Paid: ₹${total}%0AUPI ID: shayanff98@okhdfcbank%0A%0APlease confirm my order.%0A`;

window.location.href=`https://wa.me/917001568884?text=${msg}`;
}

/* THEME */
const themes=["","theme-dark","theme-emerald","theme-royal","theme-elite-red"];
let currentTheme=0;
document.getElementById("themeSwitcher").addEventListener("click",()=>{
currentTheme++;
if(currentTheme>=themes.length)currentTheme=0;
document.body.className=themes[currentTheme];
});

renderCart();
</script>

</body>
</html>
